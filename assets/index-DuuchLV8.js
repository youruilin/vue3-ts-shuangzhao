import{d as H,e as A,a as K,b as i,m as oe,p as ee,t as E,f as q,g as ae,I as ne,H as ye,n as ie,w as se,i as Oe,h as Z,j as te,k as W,r as _,l as F,u as Ae,q as rt,s as pe,v as de,x as G,y as Ne,z as ct,A as Y,B as ut,C as me,F as dt,D as Ye,E as mt,G as Ce,J as He,K as je,L as Xe,M as De,N as ft,O as Ve,P as we,Q as vt,R as Ze,S as gt,T as Be,U as ht,V as yt,W as We,X as Ke,Y as wt,Z as qe,$ as bt,a0 as Me,a1 as xt,c as Ct,a2 as z,a3 as ve,a4 as kt,a5 as St,o as It,a6 as Dt,_ as Pt}from"./index-CQ0oNnf3.js";/* empty css              */import{S as Ot,a as pt}from"./index-DgdhKhcj.js";/* empty css              */import{F as Tt}from"./index-BlQla8LJ.js";import{N as Vt}from"./index-Bc263qfS.js";import{t as Bt}from"./task-CIxoyhgX.js";import{u as Mt,a as Et}from"./my-DqMvBAnD.js";import{m as _t}from"./my-Dcnhn6DJ.js";import{p as $t,P as Ge,a as Rt,L as be,u as Je,b as re,m as Lt,c as Ft,s as le}from"./request-CHV5RleW.js";import"./task-1Y9u8IIT.js";const[Ut,N]=K("action-sheet"),zt=A({},Rt,{title:String,round:E,actions:ae(),closeIcon:q("cross"),closeable:E,cancelText:String,description:String,closeOnPopstate:E,closeOnClickAction:Boolean,safeAreaInsetBottom:E}),At=[...$t,"round","closeOnPopstate","safeAreaInsetBottom"];var Nt=H({name:Ut,props:zt,emits:["select","cancel","update:show"],setup(e,{slots:n,emit:o}){const t=c=>o("update:show",c),r=()=>{t(!1),o("cancel")},u=()=>{if(e.title)return i("div",{class:N("header")},[e.title,e.closeable&&i(ne,{name:e.closeIcon,class:[N("close"),ye],onClick:r},null)])},x=()=>{if(n.cancel||e.cancelText)return[i("div",{class:N("gap")},null),i("button",{type:"button",class:N("cancel"),onClick:r},[n.cancel?n.cancel():e.cancelText])]},I=c=>{if(c.icon)return i(ne,{class:N("item-icon"),name:c.icon},null)},w=(c,P)=>c.loading?i(be,{class:N("loading-icon")},null):n.action?n.action({action:c,index:P}):[i("span",{class:N("name")},[c.name]),c.subname&&i("div",{class:N("subname")},[c.subname])],p=(c,P)=>{const{color:v,loading:s,callback:M,disabled:a,className:b}=c,S=()=>{a||s||(M&&M(c),e.closeOnClickAction&&t(!1),ie(()=>o("select",c,P)))};return i("button",{type:"button",style:{color:v},class:[N("item",{loading:s,disabled:a}),b],onClick:S},[I(c),w(c,P)])},f=()=>{if(e.description||n.description){const c=n.description?n.description():e.description;return i("div",{class:N("description")},[c])}};return()=>i(Ge,oe({class:N(),position:"bottom","onUpdate:show":t},ee(e,At)),{default:()=>{var c;return[u(),f(),i("div",{class:N("content")},[e.actions.map(p),(c=n.default)==null?void 0:c.call(n)]),x()]}})}});const Yt=se(Nt),[Ht,Q,Ee]=K("picker"),Qe=e=>e.find(n=>!n.disabled)||e[0];function jt(e,n){const o=e[0];if(o){if(Array.isArray(o))return"multiple";if(n.children in o)return"cascade"}return"default"}function ge(e,n){n=Z(n,0,e.length);for(let o=n;o<e.length;o++)if(!e[o].disabled)return o;for(let o=n-1;o>=0;o--)if(!e[o].disabled)return o;return 0}const _e=(e,n,o)=>n!==void 0&&e.some(t=>t[o.value]===n);function Pe(e,n,o){const t=e.findIndex(u=>u[o.value]===n),r=ge(e,t);return e[r]}function Xt(e,n,o){const t=[];let r={[n.children]:e},u=0;for(;r&&r[n.children];){const x=r[n.children],I=o.value[u];if(r=Oe(I)?Pe(x,I,n):void 0,!r&&x.length){const w=Qe(x)[n.value];r=Pe(x,w,n)}u++,t.push(x)}return t}function Zt(e){const{transform:n}=window.getComputedStyle(e),o=n.slice(7,n.length-1).split(", ")[5];return Number(o)}function Wt(e){return A({text:"text",value:"value",children:"children"},e)}const $e=200,Re=300,Kt=15,[et,ke]=K("picker-column"),tt=Symbol(et);var qt=H({name:et,props:{value:W,fields:te(Object),options:ae(),readonly:Boolean,allowHtml:Boolean,optionHeight:te(Number),swipeDuration:te(W),visibleOptionNum:te(W)},emits:["change","clickOption","scrollInto"],setup(e,{emit:n,slots:o}){let t,r,u,x,I;const w=_(),p=_(),f=_(0),c=_(0),P=Je(),v=()=>e.options.length,s=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,M=D=>{let l=ge(e.options,D);const g=-l*e.optionHeight,k=()=>{l>v()-1&&(l=ge(e.options,D));const U=e.options[l][e.fields.value];U!==e.value&&n("change",U)};t&&g!==f.value?I=k:k(),f.value=g},a=()=>e.readonly||!e.options.length,b=D=>{t||a()||(I=null,c.value=$e,M(D),n("clickOption",e.options[D]))},S=D=>Z(Math.round(-D/e.optionHeight),0,v()-1),C=F(()=>S(f.value)),V=(D,l)=>{const g=Math.abs(D/l);D=f.value+g/.003*(D<0?-1:1);const k=S(D);c.value=+e.swipeDuration,M(k)},d=()=>{t=!1,c.value=0,I&&(I(),I=null)},h=D=>{if(!a()){if(P.start(D),t){const l=Zt(p.value);f.value=Math.min(0,l-s())}c.value=0,r=f.value,u=Date.now(),x=r,I=null}},R=D=>{if(a())return;P.move(D),P.isVertical()&&(t=!0,de(D,!0));const l=Z(r+P.deltaY.value,-(v()*e.optionHeight),e.optionHeight),g=S(l);g!==C.value&&n("scrollInto",e.options[g]),f.value=l;const k=Date.now();k-u>Re&&(u=k,x=l)},m=()=>{if(a())return;const D=f.value-x,l=Date.now()-u;if(l<Re&&Math.abs(D)>Kt){V(D,l);return}const k=S(f.value);c.value=$e,M(k),setTimeout(()=>{t=!1},0)},O=()=>{const D={height:`${e.optionHeight}px`};return e.options.map((l,g)=>{const k=l[e.fields.text],{disabled:U}=l,j=l[e.fields.value],y={role:"button",style:D,tabindex:U?-1:0,class:[ke("item",{disabled:U,selected:j===e.value}),l.className],onClick:()=>b(g)},T={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:k};return i("li",y,[o.option?o.option(l,g):i("div",T,null)])})};return Ae(tt),re({stopMomentum:d}),rt(()=>{const D=t?Math.floor(-f.value/e.optionHeight):e.options.findIndex(k=>k[e.fields.value]===e.value),l=ge(e.options,D),g=-l*e.optionHeight;t&&l<D&&d(),f.value=g}),pe("touchmove",R,{target:w}),()=>i("div",{ref:w,class:ke(),onTouchstartPassive:h,onTouchend:m,onTouchcancel:m},[i("ul",{ref:p,style:{transform:`translate3d(0, ${f.value+s()}px, 0)`,transitionDuration:`${c.value}ms`,transitionProperty:c.value?"all":"none"},class:ke("wrapper"),onTransitionend:d},[O()])])}});const[Gt]=K("picker-toolbar"),xe={title:String,cancelButtonText:String,confirmButtonText:String},Jt=["cancel","confirm","title","toolbar"],Qt=Object.keys(xe);var en=H({name:Gt,props:xe,emits:["confirm","cancel"],setup(e,{emit:n,slots:o}){const t=()=>{if(o.title)return o.title();if(e.title)return i("div",{class:[Q("title"),"van-ellipsis"]},[e.title])},r=()=>n("cancel"),u=()=>n("confirm"),x=()=>{var w;const p=(w=e.cancelButtonText)!=null?w:Ee("cancel");if(!(!o.cancel&&!p))return i("button",{type:"button",class:[Q("cancel"),ye],onClick:r},[o.cancel?o.cancel():p])},I=()=>{var w;const p=(w=e.confirmButtonText)!=null?w:Ee("confirm");if(!(!o.confirm&&!p))return i("button",{type:"button",class:[Q("confirm"),ye],onClick:u},[o.confirm?o.confirm():p])};return()=>i("div",{class:Q("toolbar")},[o.toolbar?o.toolbar():[x(),t(),I()]])}});const[tn,io]=K("picker-group"),nn=Symbol(tn);A({tabs:ae(),activeTab:G(0),nextStepText:String,showToolbar:E},xe);const Te=A({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:G(44),showToolbar:E,swipeDuration:G(1e3),visibleOptionNum:G(6)},xe),on=A({},Te,{columns:ae(),modelValue:ae(),toolbarPosition:q("top"),columnsFieldNames:Object});var an=H({name:Ht,props:on,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:n,slots:o}){const t=_(),r=_(e.modelValue.slice(0)),{parent:u}=Ae(nn),{children:x,linkChildren:I}=Ne(tt);I();const w=F(()=>Wt(e.columnsFieldNames)),p=F(()=>ct(e.optionHeight)),f=F(()=>jt(e.columns,w.value)),c=F(()=>{const{columns:l}=e;switch(f.value){case"multiple":return l;case"cascade":return Xt(l,w.value,r);default:return[l]}}),P=F(()=>c.value.some(l=>l.length)),v=F(()=>c.value.map((l,g)=>Pe(l,r.value[g],w.value))),s=F(()=>c.value.map((l,g)=>l.findIndex(k=>k[w.value.value]===r.value[g]))),M=(l,g)=>{if(r.value[l]!==g){const k=r.value.slice(0);k[l]=g,r.value=k}},a=()=>({selectedValues:r.value.slice(0),selectedOptions:v.value,selectedIndexes:s.value}),b=(l,g)=>{M(g,l),f.value==="cascade"&&r.value.forEach((k,U)=>{const j=c.value[U];_e(j,k,w.value)||M(U,j.length?j[0][w.value.value]:void 0)}),ie(()=>{n("change",A({columnIndex:g},a()))})},S=(l,g)=>{const k={columnIndex:g,currentOption:l};n("clickOption",A(a(),k)),n("scrollInto",k)},C=()=>{x.forEach(g=>g.stopMomentum());const l=a();return ie(()=>{const g=a();n("confirm",g)}),l},V=()=>n("cancel",a()),d=()=>c.value.map((l,g)=>i(qt,{value:r.value[g],fields:w.value,options:l,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:p.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:k=>b(k,g),onClickOption:k=>S(k,g),onScrollInto:k=>{n("scrollInto",{currentOption:k,columnIndex:g})}},{option:o.option})),h=l=>{if(P.value){const g={height:`${p.value}px`},k={backgroundSize:`100% ${(l-p.value)/2}px`};return[i("div",{class:Q("mask"),style:k},null),i("div",{class:[ut,Q("frame")],style:g},null)]}},R=()=>{const l=p.value*+e.visibleOptionNum,g={height:`${l}px`};return!e.loading&&!P.value&&o.empty?o.empty():i("div",{ref:t,class:Q("columns"),style:g},[d(),h(l)])},m=()=>{if(e.showToolbar&&!u)return i(en,oe(ee(e,Qt),{onConfirm:C,onCancel:V}),ee(o,Jt))};Y(c,l=>{l.forEach((g,k)=>{g.length&&!_e(g,r.value[k],w.value)&&M(k,Qe(g)[w.value.value])})},{immediate:!0});let O;return Y(()=>e.modelValue,l=>{!me(l,r.value)&&!me(l,O)&&(r.value=l.slice(0),O=l.slice(0))},{deep:!0}),Y(r,l=>{me(l,e.modelValue)||(O=l.slice(0),n("update:modelValue",O))},{immediate:!0}),pe("touchmove",de,{target:t}),re({confirm:C,getSelectedOptions:()=>v.value}),()=>{var l,g;return i("div",{class:Q()},[e.toolbarPosition==="top"?m():null,e.loading?i(be,{class:Q("loading")},null):null,(l=o["columns-top"])==null?void 0:l.call(o),R(),(g=o["columns-bottom"])==null?void 0:g.call(o),e.toolbarPosition==="bottom"?m():null])}}});const nt=se(an),[ln,sn]=K("form"),rn={colon:Boolean,disabled:Boolean,readonly:Boolean,required:[Boolean,String],showError:Boolean,labelWidth:W,labelAlign:String,inputAlign:String,scrollToError:Boolean,scrollToErrorPosition:String,validateFirst:Boolean,submitOnEnter:E,showErrorMessage:E,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var cn=H({name:ln,props:rn,emits:["submit","failed"],setup(e,{emit:n,slots:o}){const{children:t,linkChildren:r}=Ne(dt),u=a=>a?t.filter(b=>a.includes(b.name)):t,x=a=>new Promise((b,S)=>{const C=[];u(a).reduce((d,h)=>d.then(()=>{if(!C.length)return h.validate().then(R=>{R&&C.push(R)})}),Promise.resolve()).then(()=>{C.length?S(C):b()})}),I=a=>new Promise((b,S)=>{const C=u(a);Promise.all(C.map(V=>V.validate())).then(V=>{V=V.filter(Boolean),V.length?S(V):b()})}),w=a=>{const b=t.find(S=>S.name===a);return b?new Promise((S,C)=>{b.validate().then(V=>{V?C(V):S()})}):Promise.reject()},p=a=>typeof a=="string"?w(a):e.validateFirst?x(a):I(a),f=a=>{typeof a=="string"&&(a=[a]),u(a).forEach(S=>{S.resetValidation()})},c=()=>t.reduce((a,b)=>(a[b.name]=b.getValidationStatus(),a),{}),P=(a,b)=>{t.some(S=>S.name===a?(S.$el.scrollIntoView(b),!0):!1)},v=()=>t.reduce((a,b)=>(b.name!==void 0&&(a[b.name]=b.formValue.value),a),{}),s=()=>{const a=v();p().then(()=>n("submit",a)).catch(b=>{n("failed",{values:a,errors:b});const{scrollToError:S,scrollToErrorPosition:C}=e;S&&b[0].name&&P(b[0].name,C?{block:C}:void 0)})},M=a=>{de(a),s()};return r({props:e}),re({submit:s,validate:p,getValues:v,scrollToField:P,resetValidation:f,getValidationStatus:c}),()=>{var a;return i("form",{class:sn(),onSubmit:M},[(a=o.default)==null?void 0:a.call(o)])}}});const un=se(cn),dn=A({},Te,{modelValue:ae(),filter:Function,formatter:{type:Function,default:(e,n)=>n}}),mn=Object.keys(Te);function fn(e,n){if(e<0)return[];const o=Array(e);let t=-1;for(;++t<e;)o[t]=n(t);return o}const vn=(e,n)=>32-new Date(e,n-1,32).getDate(),Se=(e,n,o,t,r,u)=>{const x=fn(n-e+1,I=>{const w=Ye(e+I);return t(o,{text:w,value:w})});return r?r(o,x,u):x},gn=(e,n)=>e.map((o,t)=>{const r=n[t];if(r.length){const u=+r[0].value,x=+r[r.length-1].value;return Ye(Z(+o,u,x))}return o}),[hn,ce]=K("image"),yn={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:W,height:W,radius:W,lazyLoad:Boolean,iconSize:W,showError:E,errorIcon:q("photo-fail"),iconPrefix:String,showLoading:E,loadingIcon:q("photo"),crossorigin:String,referrerpolicy:String};var wn=H({name:hn,props:yn,emits:["load","error"],setup(e,{emit:n,slots:o}){const t=_(!1),r=_(!0),u=_(),{$Lazyload:x}=mt().proxy,I=F(()=>{const a={width:Ce(e.width),height:Ce(e.height)};return Oe(e.radius)&&(a.overflow="hidden",a.borderRadius=Ce(e.radius)),a});Y(()=>e.src,()=>{t.value=!1,r.value=!0});const w=a=>{r.value&&(r.value=!1,n("load",a))},p=()=>{const a=new Event("load");Object.defineProperty(a,"target",{value:u.value,enumerable:!0}),w(a)},f=a=>{t.value=!0,r.value=!1,n("error",a)},c=(a,b,S)=>S?S():i(ne,{name:a,size:e.iconSize,class:b,classPrefix:e.iconPrefix},null),P=()=>{if(r.value&&e.showLoading)return i("div",{class:ce("loading")},[c(e.loadingIcon,ce("loading-icon"),o.loading)]);if(t.value&&e.showError)return i("div",{class:ce("error")},[c(e.errorIcon,ce("error-icon"),o.error)])},v=()=>{if(t.value||!e.src)return;const a={alt:e.alt,class:ce("img"),style:{objectFit:e.fit,objectPosition:e.position},crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy};return e.lazyLoad?De(i("img",oe({ref:u},a),null),[[ft("lazy"),e.src]]):i("img",oe({ref:u,src:e.src,onLoad:w,onError:f},a),null)},s=({el:a})=>{const b=()=>{a===u.value&&r.value&&p()};u.value?b():ie(b)},M=({el:a})=>{a===u.value&&!t.value&&f()};return x&&He&&(x.$on("loaded",s),x.$on("error",M),je(()=>{x.$off("loaded",s),x.$off("error",M)})),Xe(()=>{ie(()=>{var a;(a=u.value)!=null&&a.complete&&!e.lazyLoad&&p()})}),()=>{var a;return i("div",{class:ce({round:e.round,block:e.block}),style:I.value},[v(),P(),(a=o.default)==null?void 0:a.call(o)])}}});const ot=se(wn),Le=new Date().getFullYear(),[bn]=K("date-picker"),xn=A({},dn,{columnsType:{type:Array,default:()=>["year","month","day"]},minDate:{type:Date,default:()=>new Date(Le-10,0,1),validator:Ve},maxDate:{type:Date,default:()=>new Date(Le+10,11,31),validator:Ve}});var Cn=H({name:bn,props:xn,emits:["confirm","cancel","change","update:modelValue"],setup(e,{emit:n,slots:o}){const t=_(e.modelValue),r=_(!1),u=_(),x=F(()=>r.value?e.modelValue:t.value),I=d=>d===e.minDate.getFullYear(),w=d=>d===e.maxDate.getFullYear(),p=d=>d===e.minDate.getMonth()+1,f=d=>d===e.maxDate.getMonth()+1,c=d=>{const{minDate:h,columnsType:R}=e,m=R.indexOf(d),O=x.value[m];if(O)return+O;switch(d){case"year":return h.getFullYear();case"month":return h.getMonth()+1;case"day":return h.getDate()}},P=()=>{const d=e.minDate.getFullYear(),h=e.maxDate.getFullYear();return Se(d,h,"year",e.formatter,e.filter,x.value)},v=()=>{const d=c("year"),h=I(d)?e.minDate.getMonth()+1:1,R=w(d)?e.maxDate.getMonth()+1:12;return Se(h,R,"month",e.formatter,e.filter,x.value)},s=()=>{const d=c("year"),h=c("month"),R=I(d)&&p(h)?e.minDate.getDate():1,m=w(d)&&f(h)?e.maxDate.getDate():vn(d,h);return Se(R,m,"day",e.formatter,e.filter,x.value)},M=()=>{var d;return(d=u.value)==null?void 0:d.confirm()},a=()=>t.value,b=F(()=>e.columnsType.map(d=>{switch(d){case"year":return P();case"month":return v();case"day":return s();default:return[]}}));Y(t,d=>{me(d,e.modelValue)||n("update:modelValue",d)}),Y(()=>e.modelValue,(d,h)=>{r.value=me(h,t.value),d=gn(d,b.value),me(d,t.value)||(t.value=d),r.value=!1},{immediate:!0});const S=(...d)=>n("change",...d),C=(...d)=>n("cancel",...d),V=(...d)=>n("confirm",...d);return re({confirm:M,getSelectedDate:a}),()=>i(nt,oe({ref:u,modelValue:t.value,"onUpdate:modelValue":d=>t.value=d,columns:b.value,onChange:S,onCancel:C,onConfirm:V},ee(e,mn)),o)}});const kn=se(Cn),Fe=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),Sn=e=>({x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2}),Ie=K("image-preview")[1],Ue=2.6,In={src:String,show:Boolean,active:Number,minZoom:te(W),maxZoom:te(W),rootWidth:te(Number),rootHeight:te(Number),disableZoom:Boolean,doubleScale:Boolean,closeOnClickImage:Boolean,closeOnClickOverlay:Boolean,vertical:Boolean};var Dn=H({props:In,emits:["scale","close","longPress"],setup(e,{emit:n,slots:o}){const t=we({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,initializing:!1,imageRatio:0}),r=Je(),u=_(),x=_(),I=_(!1),w=_(!1);let p=0;const f=F(()=>{const{scale:y,moveX:T,moveY:B,moving:L,zooming:X,initializing:J}=t,fe={transitionDuration:X||L||J?"0s":".3s"};return(y!==1||w.value)&&(fe.transform=`matrix(${y}, 0, 0, ${y}, ${T}, ${B})`),fe}),c=F(()=>{if(t.imageRatio){const{rootWidth:y,rootHeight:T}=e,B=I.value?T/t.imageRatio:y;return Math.max(0,(t.scale*B-y)/2)}return 0}),P=F(()=>{if(t.imageRatio){const{rootWidth:y,rootHeight:T}=e,B=I.value?T:y*t.imageRatio;return Math.max(0,(t.scale*B-T)/2)}return 0}),v=(y,T)=>{var B;if(y=Z(y,+e.minZoom,+e.maxZoom+1),y!==t.scale){const L=y/t.scale;if(t.scale=y,T){const X=Ze((B=u.value)==null?void 0:B.$el),J={x:X.width*.5,y:X.height*.5},fe=t.moveX-(T.x-X.left-J.x)*(L-1),st=t.moveY-(T.y-X.top-J.y)*(L-1);t.moveX=Z(fe,-c.value,c.value),t.moveY=Z(st,-P.value,P.value)}else t.moveX=0,t.moveY=w.value?p:0;n("scale",{scale:y,index:e.active})}},s=()=>{v(1)},M=()=>{const y=t.scale>1?1:2;v(y,y===2||w.value?{x:r.startX.value,y:r.startY.value}:void 0)};let a,b,S,C,V,d,h,R,m=!1;const O=y=>{const{touches:T}=y;if(a=T.length,a===2&&e.disableZoom)return;const{offsetX:B}=r;r.start(y),b=t.moveX,S=t.moveY,R=Date.now(),m=!1,t.moving=a===1&&(t.scale!==1||w.value),t.zooming=a===2&&!B.value,t.zooming&&(C=t.scale,V=Fe(T))},D=y=>{const{touches:T}=y;if(r.move(y),t.moving){const{deltaX:B,deltaY:L}=r,X=B.value+b,J=L.value+S;if((e.vertical?r.isVertical()&&Math.abs(J)>P.value:r.isHorizontal()&&Math.abs(X)>c.value)&&!m){t.moving=!1;return}m=!0,de(y,!0),t.moveX=Z(X,-c.value,c.value),t.moveY=Z(J,-P.value,P.value)}if(t.zooming&&(de(y,!0),T.length===2)){const B=Fe(T),L=C*B/V;d=Sn(T),v(L,d)}},l=y=>{var T;const B=(T=x.value)==null?void 0:T.$el;if(!B)return;const L=B.firstElementChild,X=y.target===B,J=L==null?void 0:L.contains(y.target);!e.closeOnClickImage&&J||!e.closeOnClickOverlay&&X||n("close")},g=y=>{if(a>1)return;const T=Date.now()-R,B=250;r.isTap.value&&(T<B?e.doubleScale?h?(clearTimeout(h),h=null,M()):h=setTimeout(()=>{l(y),h=null},B):l(y):T>gt&&n("longPress"))},k=y=>{let T=!1;if((t.moving||t.zooming)&&(T=!0,t.moving&&b===t.moveX&&S===t.moveY&&(T=!1),!y.touches.length)){t.zooming&&(t.moveX=Z(t.moveX,-c.value,c.value),t.moveY=Z(t.moveY,-P.value,P.value),t.zooming=!1),t.moving=!1,b=0,S=0,C=1,t.scale<1&&s();const B=+e.maxZoom;t.scale>B&&v(B,d)}de(y,T),g(y),r.reset()},U=()=>{const{rootWidth:y,rootHeight:T}=e,B=T/y,{imageRatio:L}=t;I.value=t.imageRatio>B&&L<Ue,w.value=t.imageRatio>B&&L>=Ue,w.value&&(p=(L*y-T)/2,t.moveY=p,t.initializing=!0,vt(()=>{t.initializing=!1})),s()},j=y=>{const{naturalWidth:T,naturalHeight:B}=y.target;t.imageRatio=B/T,U()};return Y(()=>e.active,s),Y(()=>e.show,y=>{y||s()}),Y(()=>[e.rootWidth,e.rootHeight],U),pe("touchmove",D,{target:F(()=>{var y;return(y=x.value)==null?void 0:y.$el})}),re({resetScale:s}),()=>{const y={loading:()=>i(be,{type:"spinner"},null)};return i(Ot,{ref:x,class:Ie("swipe-item"),onTouchstartPassive:O,onTouchend:k,onTouchcancel:k},{default:()=>[o.image?i("div",{class:Ie("image-wrap")},[o.image({src:e.src,onLoad:j,style:f.value})]):i(ot,{ref:u,src:e.src,fit:"contain",class:Ie("image",{vertical:I.value}),style:f.value,onLoad:j},y)]})}}});const[Pn,ue]=K("image-preview"),On=["show","teleport","transition","overlayStyle","closeOnPopstate"],pn={show:Boolean,loop:E,images:ae(),minZoom:G(1/3),maxZoom:G(3),overlay:E,vertical:Boolean,closeable:Boolean,showIndex:E,className:Be,closeIcon:q("clear"),transition:String,beforeClose:Function,doubleScale:E,overlayClass:Be,overlayStyle:Object,swipeDuration:G(300),startPosition:G(0),showIndicators:Boolean,closeOnPopstate:E,closeOnClickImage:E,closeOnClickOverlay:E,closeIconPosition:q("top-right"),teleport:[String,Object]};var at=H({name:Pn,props:pn,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:n,slots:o}){const t=_(),r=_(),u=we({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),x=()=>{if(t.value){const C=Ze(t.value.$el);u.rootWidth=C.width,u.rootHeight=C.height,t.value.resize()}},I=C=>n("scale",C),w=C=>n("update:show",C),p=()=>{We(e.beforeClose,{args:[u.active],done:()=>w(!1)})},f=C=>{C!==u.active&&(u.active=C,n("change",C))},c=()=>{if(e.showIndex)return i("div",{class:ue("index")},[o.index?o.index({index:u.active}):`${u.active+1} / ${e.images.length}`])},P=()=>{if(o.cover)return i("div",{class:ue("cover")},[o.cover()])},v=()=>{u.disableZoom=!0},s=()=>{u.disableZoom=!1},M=()=>i(pt,{ref:t,lazyRender:!0,loop:e.loop,class:ue("swipe"),vertical:e.vertical,duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:f,onDragEnd:s,onDragStart:v},{default:()=>[e.images.map((C,V)=>i(Dn,{ref:d=>{V===u.active&&(r.value=d)},src:C,show:e.show,active:u.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:u.rootWidth,rootHeight:u.rootHeight,disableZoom:u.disableZoom,doubleScale:e.doubleScale,closeOnClickImage:e.closeOnClickImage,closeOnClickOverlay:e.closeOnClickOverlay,vertical:e.vertical,onScale:I,onClose:p,onLongPress:()=>n("longPress",{index:V})},{image:o.image}))]}),a=()=>{if(e.closeable)return i(ne,{role:"button",name:e.closeIcon,class:[ue("close-icon",e.closeIconPosition),ye],onClick:p},null)},b=()=>n("closed"),S=(C,V)=>{var d;return(d=t.value)==null?void 0:d.swipeTo(C,V)};return re({resetScale:()=>{var C;(C=r.value)==null||C.resetScale()},swipeTo:S}),Xe(x),Y([ht,yt],x),Y(()=>e.startPosition,C=>f(+C)),Y(()=>e.show,C=>{const{images:V,startPosition:d}=e;C?(f(+d),ie(()=>{x(),S(+d,{immediate:!0})})):n("close",{index:u.active,url:V[u.active]})}),()=>i(Ge,oe({class:[ue(),e.className],overlayClass:[ue("overlay"),e.overlayClass],onClosed:b,"onUpdate:show":w},ee(e,On)),{default:()=>[a(),M(),c(),P()]})}});let he;const Tn={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,vertical:!1,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,doubleScale:!0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeOnClickOverlay:!0,closeIconPosition:"top-right"};function Vn(){({instance:he}=Lt({setup(){const{state:e,toggle:n}=Ft(),o=()=>{e.images=[]};return()=>i(at,oe(e,{onClosed:o,"onUpdate:show":n}),null)}}))}const Bn=(e,n=0)=>{if(He)return he||Vn(),e=Array.isArray(e)?{images:e,startPosition:n}:e,he.open(A({},Tn,e)),he};se(at);const[Mn,$,En]=K("uploader");function ze(e,n){return new Promise(o=>{if(n==="file"){o();return}const t=new FileReader;t.onload=r=>{o(r.target.result)},n==="dataUrl"?t.readAsDataURL(e):n==="text"&&t.readAsText(e)})}function lt(e,n){return Ke(e).some(o=>o.file?wt(n)?n(o.file):o.file.size>+n:!1)}function _n(e,n){const o=[],t=[];return e.forEach(r=>{lt(r,n)?t.push(r):o.push(r)}),{valid:o,invalid:t}}const $n=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,Rn=e=>$n.test(e);function it(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?Rn(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var Ln=H({props:{name:W,item:te(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,reupload:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview","reupload"],setup(e,{emit:n,slots:o}){const t=()=>{const{status:f,message:c}=e.item;if(f==="uploading"||f==="failed"){const P=f==="failed"?i(ne,{name:"close",class:$("mask-icon")},null):i(be,{class:$("loading")},null),v=Oe(c)&&c!=="";return i("div",{class:$("mask")},[P,v&&i("div",{class:$("mask-message")},[c])])}},r=f=>{const{name:c,item:P,index:v,beforeDelete:s}=e;f.stopPropagation(),We(s,{args:[P,{name:c,index:v}],done:()=>n("delete")})},u=()=>n("preview"),x=()=>n("reupload"),I=()=>{if(e.deletable&&e.item.status!=="uploading"){const f=o["preview-delete"];return i("div",{role:"button",class:$("preview-delete",{shadow:!f}),tabindex:0,"aria-label":En("delete"),onClick:r},[f?f():i(ne,{name:"cross",class:$("preview-delete-icon")},null)])}},w=()=>{if(o["preview-cover"]){const{index:f,item:c}=e;return i("div",{class:$("preview-cover")},[o["preview-cover"](A({index:f},c))])}},p=()=>{const{item:f,lazyLoad:c,imageFit:P,previewSize:v,reupload:s}=e;return it(f)?i(ot,{fit:P,src:f.objectUrl||f.content||f.url,class:$("preview-image"),width:Array.isArray(v)?v[0]:v,height:Array.isArray(v)?v[1]:v,lazyLoad:c,onClick:s?x:u},{default:w}):i("div",{class:$("file"),style:qe(e.previewSize)},[i(ne,{class:$("file-icon"),name:"description"},null),i("div",{class:[$("file-name"),"van-ellipsis"]},[f.file?f.file.name:f.url]),w()])};return()=>i("div",{class:$("preview")},[p(),t(),I()])}});const Fn={name:G(""),accept:q("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:G(1/0),imageFit:q("cover"),resultType:q("dataUrl"),uploadIcon:q("photograph"),uploadText:String,deletable:E,reupload:Boolean,afterRead:Function,showUpload:E,modelValue:ae(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:E,previewOptions:Object,previewFullImage:E,maxSize:{type:[Number,String,Function],default:1/0}};var Un=H({name:Mn,props:Fn,emits:["delete","oversize","clickUpload","closePreview","clickPreview","clickReupload","update:modelValue"],setup(e,{emit:n,slots:o}){const t=_(),r=[],u=_(-1),x=_(!1),I=(m=e.modelValue.length)=>({name:e.name,index:m}),w=()=>{t.value&&(t.value.value="")},p=m=>{if(w(),lt(m,e.maxSize))if(Array.isArray(m)){const O=_n(m,e.maxSize);if(m=O.valid,n("oversize",O.invalid,I()),!m.length)return}else{n("oversize",m,I());return}if(m=we(m),u.value>-1){const O=[...e.modelValue];O.splice(u.value,1,m),n("update:modelValue",O),u.value=-1}else n("update:modelValue",[...e.modelValue,...Ke(m)]);e.afterRead&&e.afterRead(m,I())},f=m=>{const{maxCount:O,modelValue:D,resultType:l}=e;if(Array.isArray(m)){const g=+O-D.length;m.length>g&&(m=m.slice(0,g)),Promise.all(m.map(k=>ze(k,l))).then(k=>{const U=m.map((j,y)=>{const T={file:j,status:"",message:"",objectUrl:URL.createObjectURL(j)};return k[y]&&(T.content=k[y]),T});p(U)})}else ze(m,l).then(g=>{const k={file:m,status:"",message:"",objectUrl:URL.createObjectURL(m)};g&&(k.content=g),p(k)})},c=m=>{const{files:O}=m.target;if(e.disabled||!O||!O.length)return;const D=O.length===1?O[0]:[].slice.call(O);if(e.beforeRead){const l=e.beforeRead(D,I());if(!l){w();return}if(xt(l)){l.then(g=>{f(g||D)}).catch(w);return}}f(D)};let P;const v=()=>n("closePreview"),s=m=>{if(e.previewFullImage){const O=e.modelValue.filter(it),D=O.map(l=>(l.objectUrl&&!l.url&&l.status!=="failed"&&(l.url=l.objectUrl,r.push(l.url)),l.url)).filter(Boolean);P=Bn(A({images:D,startPosition:O.indexOf(m),onClose:v},e.previewOptions))}},M=()=>{P&&P.close()},a=(m,O)=>{const D=e.modelValue.slice(0);D.splice(O,1),n("update:modelValue",D),n("delete",m,I(O))},b=m=>{x.value=!0,u.value=m,ie(()=>R())},S=()=>{x.value||(u.value=-1),x.value=!1},C=(m,O)=>{const D=["imageFit","deletable","reupload","previewSize","beforeDelete"],l=A(ee(e,D),ee(m,D,!0));return i(Ln,oe({item:m,index:O,onClick:()=>n(e.reupload?"clickReupload":"clickPreview",m,I(O)),onDelete:()=>a(m,O),onPreview:()=>s(m),onReupload:()=>b(O)},ee(e,["name","lazyLoad"]),l),ee(o,["preview-cover","preview-delete"]))},V=()=>{if(e.previewImage)return e.modelValue.map(C)},d=m=>n("clickUpload",m),h=()=>{const m=e.modelValue.length<+e.maxCount,O=e.readonly?null:i("input",{ref:t,type:"file",class:$("input"),accept:e.accept,capture:e.capture,multiple:e.multiple&&u.value===-1,disabled:e.disabled,onChange:c,onClick:S},null);return o.default?De(i("div",{class:$("input-wrapper"),onClick:d},[o.default(),O]),[[Me,m]]):De(i("div",{class:$("upload",{readonly:e.readonly}),style:qe(e.previewSize),onClick:d},[i(ne,{name:e.uploadIcon,class:$("upload-icon")},null),e.uploadText&&i("span",{class:$("upload-text")},[e.uploadText]),O]),[[Me,e.showUpload&&m]])},R=()=>{t.value&&!e.disabled&&t.value.click()};return je(()=>{r.forEach(m=>URL.revokeObjectURL(m))}),re({chooseFile:R,reuploadFile:b,closeImagePreview:M}),bt(()=>e.modelValue),()=>i("div",{class:$()},[i("div",{class:$("wrapper",{disabled:e.disabled})},[V(),h()])])}});const zn=se(Un),An={class:"user-page"},Nn={class:"user-pic"},Yn={class:"user-item"},Hn={class:"user-item"},jn={class:"user-item"},Xn={class:"user-item"},Zn={class:"user-item"},Wn=H({__name:"index",setup(e){const n=Bt();n.areaList.length||(console.log("测试进程"),n.getCityList(),console.log(n.areaList,"if"));const o=_t(),t=we({fileList:[],userName:"",showSex:!1,sex:"",birthDay:"",showBirth:!1,workDay:"",showWorkDay:!1,minDate:new Date(1980,0,1),maxDate:new Date(2007,0,1),showCity:!1,city:"",area:"",loading:!1,columnsType:["year","month"]}),r=v=>{t.birthDay=v.selectedValues[0]+"-"+v.selectedValues[1],t.showBirth=!1},u=v=>{t.workDay=v.selectedValues[0]+"-"+v.selectedValues[1],t.showWorkDay=!1},x=[{name:"男"},{name:"女"}],I=async v=>{v.status="uploading",v.message="上传中...";let s=new FormData;s.append("user","test"),s.append("file",v.file);const M=await Mt(s);v.url=M.imageUrl,v.status="success",v.message="上传成功",t.fileList=[v]},w=()=>history.back(),p=()=>{t.userName=o.userInfo.user_name,t.sex=St.sex(o.userInfo.sex),t.birthDay=o.userInfo.birthday,t.workDay=o.userInfo.work_time,t.city=o.userInfo.city,t.area=o.userInfo.area,o.userInfo.it_head&&(t.fileList=[{url:o.userInfo.it_head}])};o.userInfo.user_name?p():async function(){await o.getUserInfo(),p()}();const f=v=>{t.city=v.selectedOptions[0].text+"-"+v.selectedOptions[1].text,t.area=v.selectedOptions[1].text,t.showCity=!1},c=v=>{t.sex=v.name,t.showSex=!1},P=async()=>{if(t.fileList.length===0){le("请上传头像");return}if(!t.userName){le("填写姓名");return}if(!t.sex){le("您还没有选择性别");return}if(!t.birthDay){le("请选择出生年月");return}if(!t.workDay){le("请选择工作时间");return}if(!t.city){le("请选择城市");return}t.loading=!0,await Et({user_name:t.userName,sex:t.sex==="男"?1:t.sex==="女"?2:"",birthday:t.birthDay,work_time:t.workDay,city:t.city,area:t.area,it_head:t.fileList[0].url,type:1})&&o.getUserInfo(),le("修改成功"),t.loading=!1};return(v,s)=>{const M=Vt,a=zn,b=Tt,S=Yt,C=kn,V=nt,d=un;return It(),Ct(kt,null,[i(M,{title:"个人信息","left-arrow":"",onClickLeft:w}),z("div",An,[i(d,{onSubmit:P},{default:ve(()=>[z("div",Nn,[i(a,{modelValue:t.fileList,"onUpdate:modelValue":s[0]||(s[0]=h=>t.fileList=h),accept:".jpg,.png","after-read":I,"max-count":1},null,8,["modelValue"])]),z("div",Yn,[s[17]||(s[17]=z("h5",null,"姓名",-1)),i(b,{modelValue:t.userName,"onUpdate:modelValue":s[1]||(s[1]=h=>t.userName=h),label:"",placeholder:"请输入您的姓名"},null,8,["modelValue"])]),z("div",Hn,[s[18]||(s[18]=z("h5",null,"性别",-1)),i(b,{modelValue:t.sex,"onUpdate:modelValue":s[2]||(s[2]=h=>t.sex=h),readonly:"","is-link":"",label:"",placeholder:"请选择您的性别",onClick:s[3]||(s[3]=h=>t.showSex=!0)},null,8,["modelValue"]),i(S,{show:t.showSex,"onUpdate:show":s[4]||(s[4]=h=>t.showSex=h),actions:x,"cancel-text":"取消","close-on-click-action":"",onSelect:c},null,8,["show"])]),z("div",jn,[s[19]||(s[19]=z("h5",null,"出生日期",-1)),i(b,{modelValue:t.birthDay,"onUpdate:modelValue":s[5]||(s[5]=h=>t.birthDay=h),readonly:"","is-link":"",label:"",placeholder:"请选择您的出生年月",onClick:s[6]||(s[6]=h=>t.showBirth=!0)},null,8,["modelValue"]),i(S,{show:t.showBirth,"onUpdate:show":s[8]||(s[8]=h=>t.showBirth=h)},{default:ve(()=>[i(C,{title:"选择日期","min-date":t.minDate,"max-date":t.maxDate,"columns-type":t.columnsType,onConfirm:r,onCancel:s[7]||(s[7]=h=>t.showBirth=!1)},null,8,["min-date","max-date","columns-type"])]),_:1},8,["show"])]),z("div",Xn,[s[20]||(s[20]=z("h5",null,"参加工作的时间",-1)),i(b,{modelValue:t.workDay,"onUpdate:modelValue":s[9]||(s[9]=h=>t.workDay=h),label:"",readonly:"","is-link":"",placeholder:"请选择您的工作时间",onClick:s[10]||(s[10]=h=>t.showWorkDay=!0)},null,8,["modelValue"]),i(S,{show:t.showWorkDay,"onUpdate:show":s[12]||(s[12]=h=>t.showWorkDay=h)},{default:ve(()=>[i(C,{title:"选择日期","min-date":t.minDate,"max-date":t.maxDate,"columns-type":t.columnsType,onConfirm:u,onCancel:s[11]||(s[11]=h=>t.showWorkDay=!1)},null,8,["min-date","max-date","columns-type"])]),_:1},8,["show"])]),z("div",Zn,[s[21]||(s[21]=z("h5",null,"所在城市",-1)),i(b,{modelValue:t.city,"onUpdate:modelValue":s[13]||(s[13]=h=>t.city=h),label:"",placeholder:"请选择您的城市",readonly:"","is-link":"",onClick:s[14]||(s[14]=h=>t.showCity=!0)},null,8,["modelValue"]),i(S,{show:t.showCity,"onUpdate:show":s[16]||(s[16]=h=>t.showCity=h)},{default:ve(()=>[i(V,{columns:Dt(n).areaList,onConfirm:f,onCancel:s[15]||(s[15]=h=>t.showCity=!1)},null,8,["columns"])]),_:1},8,["show"])]),s[22]||(s[22]=z("button",{class:"wy-confirm-btn","native-type":"submit"},"提交修改",-1))]),_:1})])],64)}}}),so=Pt(Wn,[["__scopeId","data-v-e446df7a"]]);export{so as default};
